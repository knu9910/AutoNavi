var path = require('path');
var app = require('../app');
var socketio = require('socket.io');

require('greenlock-express')
  .init({
    packageRoot: path.join(__dirname, '..'),
    configDir: path.join(__dirname, '..', 'greenlock.d'),
    maintainerEmail: 'knu9910@gmail.com',
    cluster: false,
  })
  .serve(function (glx) {
    var server = glx.httpsServer();
    var io = socketio(server);
    app.set('io', io);
    glx.serveApp(app);
  }); // Serves on 80 and 443
